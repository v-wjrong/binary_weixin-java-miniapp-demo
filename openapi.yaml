openapi: 3.0.0
info:
  title: binary/weixin-java-miniapp-demo
  version: 1.0.0
  description: binary/weixin-java-miniapp-demo
servers:
- url: http://localhost:8080
  description: Local development server
paths:
  /wx/media/{appid}/upload:
    post:
      tags:
      - WxMaMediaController
      summary: uploadMedia
      description: 该接口处理微信小程序媒体文件上传，支持多文件同时上传，返回媒体ID列表。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.controller.WxMaMediaController#uploadMedia
      parameters:
      - in: path
        name: appid
        required: true
        description: ''
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
      deprecated: false
  /wx/media/{appid}/download/{mediaId}:
    get:
      tags:
      - WxMaMediaController
      summary: getMedia
      description: 该接口用于下载微信媒体文件。通过appid和mediaId获取对应媒体文件，若appid配置不存在则抛出异常，获取成功后清理线程本地变量并返回文件。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.controller.WxMaMediaController#getMedia
      parameters:
      - in: path
        name: appid
        required: true
        description: ''
        schema:
          type: string
      - in: path
        name: mediaId
        required: true
        description: ''
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
      deprecated: false
  /wx/user/{appid}/login:
    get:
      tags:
      - WxMaUserController
      summary: login
      description: 该接口处理微信小程序登录请求，通过appid和code获取用户会话信息。首先校验code是否为空，然后切换到对应的微信配置，调用服务获取sessionKey和openid，记录日志并返回JSON格式的会话信息。若发生异常则记录错误日志并返回异常信息，最后清理线程本地变量。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.controller.WxMaUserController#login
      parameters:
      - in: path
        name: appid
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: code
        required: true
        description: ''
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: string
      deprecated: false
  /wx/user/{appid}/info:
    get:
      tags:
      - WxMaUserController
      summary: info
      description: 该接口用于获取微信小程序用户信息，通过appid切换配置，校验用户签名并解密返回用户数据。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.controller.WxMaUserController#info
      parameters:
      - in: path
        name: appid
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: sessionKey
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: signature
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: rawData
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: encryptedData
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: iv
        required: true
        description: ''
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: string
      deprecated: false
  /wx/user/{appid}/phone:
    get:
      tags:
      - WxMaUserController
      summary: phone
      description: 该接口用于获取用户手机号，通过校验用户信息并解密加密数据来实现。首先切换到指定appid配置，校验用户信息合法性，然后解密手机号相关信息并返回结果，过程中会清理线程本地变量。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.controller.WxMaUserController#phone
      parameters:
      - in: path
        name: appid
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: sessionKey
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: signature
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: rawData
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: encryptedData
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: iv
        required: true
        description: ''
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: string
      deprecated: false
  /wx/portal/{appid}:
    get:
      tags:
      - WxPortalController
      summary: authGet
      description: 该接口用于处理微信服务器的GET认证请求，验证签名合法性并返回echostr或错误信息。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.controller.WxPortalController#authGet
      parameters:
      - in: path
        name: appid
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: signature
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: timestamp
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: nonce
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: echostr
        required: true
        description: ''
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: string
      deprecated: false
    post:
      tags:
      - WxPortalController
      summary: post
      description: 该接口处理微信小程序消息推送，支持明文和AES加密两种传输方式，根据消息格式（JSON或XML）解析并路由处理，确保线程安全并返回成功响应。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.controller.WxPortalController#post
      parameters:
      - in: path
        name: appid
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: msg_signature
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: encrypt_type
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: signature
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: timestamp
        required: true
        description: ''
        schema:
          type: string
      - in: query
        name: nonce
        required: true
        description: ''
        schema:
          type: string
      requestBody:
        description: ''
        content:
          application/json:
            schema:
              type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: string
      deprecated: false
  /error/404:
    get:
      tags:
      - ErrorController
      summary: error404
      description: 该代码定义了一个处理404错误的GET请求方法，返回"error"字符串。当用户访问不存在的页面时，系统会调用此方法并显示错误页面。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.error.ErrorController#error404
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: string
      deprecated: false
  /error/500:
    get:
      tags:
      - ErrorController
      summary: error500
      description: 该代码定义了一个处理HTTP GET请求的控制器方法，当访问路径为"/500"时，返回名为"error"的视图页面，用于处理服务器内部错误的展示。
      operationId: weixin-java-miniapp-demo_com.github.binarywang.demo.wx.miniapp.error.ErrorController#error500
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: string
      deprecated: false
components: {}
